# Отчёт по результатам анализа Kubernetes Audit Log

## Подозрительные события

1. Доступ к секретам:

- Кто: minikube-user, имитирующий system:serviceaccount:secure-ops:monitoring
- Где: /api/v1/namespaces/kube-system/secrets
- Почему подозрительно: использована техника impersonation для обхода ограничений. Запрос был отклонён (403 Forbidden), но сама попытка указывает на попытку обойти RBAC.

2. Привилегированные поды:

- Кто: minikube-user
- Комментарий: в пространстве secure-ops развернут pod privileged-pod с контейнером pwn, где в security context включён privileged: true.

3. Использование kubectl exec в чужом поде:

- Не обнаружено
4. Создание RoleBinding с правами cluster-admin:

- Не обнаружено

5. Удаление audit-policy.yaml:
    - Кто: system:apiserver от имени admin
    - Попытка скрыть следы 

## Вывод
1. Основные уязвимости

- Попытки получения доступа к секретам без соответствующих прав

- Запуск pod’ов с повышенными привилегиями

- Эскалация прав за счёт неправильной настройки RBAC

2. Рекомендации по устранению

- Пересмотреть и ужесточить правила RBAC

- Запретить создание pod’ов с флагом privileged

- Усилить контроль и аудит действий в системных пространствах имён

- Внедрить Pod Security Standards для предотвращения подобных атак

3. Недочёты в настройках RBAC

- Предоставлены чрезмерные права, выходящие за рамки задач пользователей

- Не реализован принцип «минимально необходимых привилегий»

- Нет должного разграничения доступов между разными сервисами и командами